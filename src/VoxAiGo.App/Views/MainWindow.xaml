<Window x:Class="VoxAiGo.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="VoxAiGo" Height="650" Width="900"
        WindowStartupLocation="CenterScreen" MinHeight="500" MinWidth="700"
        Background="#0A0A0A" Foreground="#FFFFFF"
        Icon="/Resources/voxaigo.ico">

    <Window.Resources>
        <!-- Inline resources to ensure they work in published app -->
        <SolidColorBrush x:Key="AppBg" Color="#0A0A0A" />
        <SolidColorBrush x:Key="SurfaceBg" Color="#141414" />
        <SolidColorBrush x:Key="SurfaceHoverBg" Color="#1C1C1C" />
        <SolidColorBrush x:Key="SurfaceActiveBg" Color="#262626" />
        <SolidColorBrush x:Key="BorderColor" Color="#1F1F1F" />
        <SolidColorBrush x:Key="GoldPrimary" Color="#D4AF37" />
        <LinearGradientBrush x:Key="GoldGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#D4AF37" Offset="0" />
            <GradientStop Color="#E8D48B" Offset="1" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="GoldHover" Color="#E8D48B" />
        <SolidColorBrush x:Key="TextPrimary" Color="#FFFFFF" />
        <SolidColorBrush x:Key="TextSecondary" Color="#8A8A8A" />
        <SolidColorBrush x:Key="DangerColor" Color="#FF3B30" />
        <SolidColorBrush x:Key="SuccessColor" Color="#34C759" />
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ===== TOAST NOTIFICATION (absolute overlay at bottom-center) ===== -->
        <Border Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,24" Panel.ZIndex="999"
                CornerRadius="12" Padding="20,12" MinWidth="300" MaxWidth="500"
                Visibility="{Binding IsToastVisible, Converter={StaticResource BoolToVis}}">
            <Border.Background>
                <SolidColorBrush Color="#2D2D2D"/>
            </Border.Background>
            <Border.Effect>
                <DropShadowEffect BlurRadius="20" Opacity="0.5" ShadowDepth="4"/>
            </Border.Effect>
            <TextBlock Text="{Binding ToastMessage}" FontSize="13" FontWeight="SemiBold"
                       Foreground="{Binding ToastColor, Converter={StaticResource StringToColor}, FallbackValue='#D4A017'}"
                       HorizontalAlignment="Center" TextWrapping="Wrap"/>
        </Border>

        <!-- ===== SIDEBAR ===== -->
        <Border Background="#141414" Grid.Column="0" BorderBrush="#1F1F1F" BorderThickness="0,0,1,0">
            <DockPanel>
                <!-- User info at bottom -->
                <Border DockPanel.Dock="Bottom" Padding="20,16" BorderBrush="#1F1F1F" BorderThickness="0,1,0,0">
                    <StackPanel Visibility="{Binding IsLoggedIn, Converter={StaticResource BoolToVis}}">
                        <TextBlock Text="{Binding Email}" FontSize="12" Foreground="#8A8A8A" TextTrimming="CharacterEllipsis"/>
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                            <Border Background="{Binding IsPro, Converter={StaticResource BoolToVis}, ConverterParameter=Gold}"
                                    CornerRadius="3" Padding="6,2" Margin="0,0,6,0">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#555"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsPro}" Value="True">
                                                <Setter Property="Background" Value="#D4A017"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Text="{Binding SubscriptionLabel}" FontSize="10" FontWeight="Bold" Foreground="White"/>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Navigation -->
                <StackPanel Margin="16,32,16,16">
                    <!-- Logo -->
                    <StackPanel HorizontalAlignment="Center" Margin="0,0,0,32">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,4">
                            <TextBlock Text="&#xE1D6;" FontFamily="Segoe MDL2 Assets" FontSize="18" Foreground="#D4AF37" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="VoxAiGo" FontSize="18" FontWeight="Bold" Foreground="#FFFFFF" VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="v3.0.0" FontSize="12" Foreground="#8A8A8A" HorizontalAlignment="Center"/>
                    </StackPanel>

                    <RadioButton GroupName="Nav" IsChecked="True" Style="{StaticResource SidebarButton}" Command="{Binding NavigateHomeCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE80F;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Home" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton GroupName="Nav" Style="{StaticResource SidebarButton}" Command="{Binding NavigateLanguagesCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Idiomas" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton GroupName="Nav" Style="{StaticResource SidebarButton}" Command="{Binding NavigateModesCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE8C4;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Modos" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton GroupName="Nav" Style="{StaticResource SidebarButton}" Command="{Binding NavigateSnippetsCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE8F1;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Snippets" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                    
                    <Border BorderBrush="#1F1F1F" BorderThickness="0,1,0,0" Margin="0,12"/>
                    
                    <RadioButton GroupName="Nav" Style="{StaticResource SidebarButton}" Command="{Binding NavigateStyleCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Aa" FontFamily="Segoe UI" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Estilo" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton GroupName="Nav" Style="{StaticResource SidebarButton}" Command="{Binding NavigateSettingsCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Ajustes" Style="{StaticResource SidebarText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </RadioButton>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- ===== CONTENT AREA ===== -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="28,24">

                <!-- ======================================== -->
                <!-- HOME SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsHomeVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Home" Style="{StaticResource H1Text}" Margin="0,0,0,24"/>

                    <!-- Current Mode & Language Cards -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Current Mode -->
                        <Border Grid.Column="0" Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel>
                                <TextBlock Text="Modo Atual" Style="{StaticResource CaptionText}" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding CurrentModeIcon}" FontFamily="Segoe MDL2 Assets" FontSize="24" Foreground="{StaticResource GoldPrimary}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBlock Text="{Binding CurrentModeName}" Style="{StaticResource H3Text}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Current Language -->
                        <Border Grid.Column="2" Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel>
                                <TextBlock Text="Idioma Atual" Style="{StaticResource CaptionText}" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding CurrentLanguageFlag}" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBlock Text="{Binding CurrentLanguageName}" Style="{StaticResource H3Text}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Stats Row -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="{Binding TodayTranscriptions}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Hoje" Style="{StaticResource CaptionText}" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2" Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="{Binding TotalTranscriptions}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Total" Style="{StaticResource CaptionText}" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="4" Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="{Binding DailyStreak}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Dias Seguidos" Style="{StaticResource CaptionText}" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Subscription Status -->
                    <Border Style="{StaticResource SectionCard}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                    <TextBlock Text="Plano: " Style="{StaticResource CaptionText}"/>
                                    <TextBlock Text="{Binding SubscriptionLabel}" Foreground="{StaticResource GoldPrimary}" FontWeight="Bold"/>
                                </StackPanel>
                                <TextBlock Text="{Binding UsageLabel}" Style="{StaticResource CaptionText}"/>
                            </StackPanel>
                            <Button Grid.Column="1" Content="Fazer Upgrade" Command="{Binding OpenSubscriptionPageCommand}"
                                    Style="{StaticResource GoldButton}" VerticalAlignment="Center" Padding="16,8"
                                    Visibility="{Binding IsPro, Converter={StaticResource InverseBoolToVis}}"/>
                        </Grid>
                    </Border>

                    <!-- Shortcut Hint -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="Segure para Gravar" Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                            <Border Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" Padding="20,10">
                                <TextBlock Text="{Binding ShortcutHint}" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource GoldPrimary}"
                                           HorizontalAlignment="Center" FontFamily="Consolas"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Recording Status -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <TextBlock Text="Status de Gravação" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>
                            <Grid Margin="0,0,0,4">
                                <TextBlock Text="Motor:" HorizontalAlignment="Left" Style="{StaticResource CaptionText}"/>
                                <TextBlock Text="{Binding ActiveEngine, FallbackValue='Nenhum'}" HorizontalAlignment="Right" FontSize="12"
                                           Foreground="{StaticResource GoldPrimary}"/>
                            </Grid>
                            <TextBlock Text="{Binding RecordingStatus, FallbackValue='Pronto — segure Ctrl+Space para gravar'}" FontSize="12"
                                       Foreground="{Binding RecordingStatusColor, Converter={StaticResource StringToColor}, FallbackValue='#D4AF37'}" TextWrapping="Wrap" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Microphone Test -->
                    <Border Style="{StaticResource SectionCard}" Margin="0">
                        <StackPanel>
                            <TextBlock Text="Teste de Microfone" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>

                            <!-- Level Bar -->
                            <ProgressBar Minimum="0" Maximum="1" Value="{Binding MicTestLevel, Mode=OneWay}"
                                         Height="8" Margin="0,0,0,12"
                                         Background="{StaticResource AppBg}" Foreground="{StaticResource SuccessColor}" BorderThickness="0"/>

                            <!-- Status -->
                            <TextBlock Text="{Binding MicTestStatus}" Style="{StaticResource CaptionText}"
                                       Foreground="{Binding MicTestStatusColor, Converter={StaticResource StringToColor}, FallbackValue='#8A8A8A'}" Margin="0,0,0,12"/>

                            <!-- Test Button -->
                            <Button Command="{Binding ToggleMicTestCommand}" HorizontalAlignment="Left">
                                <Button.Style>
                                    <Style TargetType="Button" BasedOn="{StaticResource OutlineButton}">
                                        <Setter Property="Content" Value="Testar Microfone"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsMicTesting}" Value="True">
                                                <Setter Property="Content" Value="Parar Teste"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- ======================================== -->
                <!-- LANGUAGES SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsLanguagesVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Idiomas" Style="{StaticResource H1Text}" Margin="0,0,0,8"/>
                    <TextBlock Text="Selecione seu idioma de saída. O plano gratuito inclui Português e Inglês." Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,24"/>

                    <!-- Search -->
                    <TextBox Text="{Binding LanguageSearchText, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource DarkTextBox}" Margin="0,0,0,24">
                        <TextBox.Tag>
                            <TextBlock Text="Buscar idiomas..." Foreground="{StaticResource TextSecondary}"/>
                        </TextBox.Tag>
                    </TextBox>

                    <!-- Language Grid -->
                    <ItemsControl ItemsSource="{Binding FilteredLanguages}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Command="{Binding DataContext.SelectLanguageCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding Code}" Margin="4" Padding="0" BorderThickness="0" Cursor="Hand" Background="Transparent" Foreground="{StaticResource TextPrimary}">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="card" CornerRadius="12" Padding="16,12" Width="160" Cursor="Hand"
                                                    BorderThickness="2">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="{StaticResource SurfaceBg}"/>
                                                        <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                                <Setter Property="Background" Value="{StaticResource SurfaceActiveBg}"/>
                                                                <Setter Property="BorderBrush" Value="{StaticResource GoldPrimary}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="{Binding Flag}" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="{Binding DisplayName}" Style="{StaticResource BodyText}" FontWeight="Medium"
                                                                   Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Code}" Style="{StaticResource CaptionText}"
                                                                   FontFamily="Consolas" Margin="0,0,12,0" VerticalAlignment="Center" Foreground="{StaticResource TextSecondary}"/>
                                                        <Border CornerRadius="4" Padding="6,2" VerticalAlignment="Center" Visibility="{Binding IsFreeTier, Converter={StaticResource BoolToVis}}">
                                                            <Border.Background>
                                                                <SolidColorBrush Color="#34C759" Opacity="0.15"/>
                                                            </Border.Background>
                                                            <TextBlock Text="GRÁTIS" FontSize="10" FontWeight="Bold" Foreground="{StaticResource SuccessColor}"/>
                                                        </Border>
                                                        <Border CornerRadius="4" Padding="6,2" VerticalAlignment="Center" Visibility="{Binding IsLocked, Converter={StaticResource BoolToVis}}">
                                                            <Border.Background>
                                                                <SolidColorBrush Color="#D4AF37" Opacity="0.15"/>
                                                            </Border.Background>
                                                            <TextBlock Text="PRO" FontSize="10" FontWeight="Bold" Foreground="{StaticResource GoldPrimary}"/>
                                                        </Border>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="card" Property="Background" Value="{StaticResource SurfaceHoverBg}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- ======================================== -->
                <!-- MODES SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsModesVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Modos de Transcrição" Style="{StaticResource H1Text}" Margin="0,0,0,8"/>
                    <TextBlock Text="Escolha como sua voz é processada. O plano gratuito inclui o modo Texto." Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,24"/>

                    <ItemsControl ItemsSource="{Binding Modes}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Command="{Binding DataContext.SelectModeCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding Name}" Margin="4" Padding="0" BorderThickness="0" Cursor="Hand" Background="Transparent" Foreground="{StaticResource TextPrimary}">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="card" CornerRadius="12" Padding="20,16" Width="200" Cursor="Hand"
                                                    BorderThickness="2">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="{StaticResource SurfaceBg}"/>
                                                        <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                                <Setter Property="Background" Value="{StaticResource SurfaceActiveBg}"/>
                                                                <Setter Property="BorderBrush" Value="{StaticResource GoldPrimary}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                        <TextBlock Text="{Binding Icon}" FontFamily="Segoe MDL2 Assets" FontSize="24"
                                                                   Foreground="{StaticResource GoldPrimary}" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="{Binding Name}" Style="{StaticResource BodyText}" FontWeight="Medium"
                                                                   Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border CornerRadius="4" Padding="6,2" Visibility="{Binding IsFreeTier, Converter={StaticResource BoolToVis}}">
                                                            <Border.Background>
                                                                <SolidColorBrush Color="#34C759" Opacity="0.15"/>
                                                            </Border.Background>
                                                            <TextBlock Text="GRÁTIS" FontSize="10" FontWeight="Bold" Foreground="{StaticResource SuccessColor}"/>
                                                        </Border>
                                                        <Border CornerRadius="4" Padding="6,2" Visibility="{Binding IsLocked, Converter={StaticResource BoolToVis}}">
                                                            <Border.Background>
                                                                <SolidColorBrush Color="#D4AF37" Opacity="0.15"/>
                                                            </Border.Background>
                                                            <TextBlock Text="PRO" FontSize="10" FontWeight="Bold" Foreground="{StaticResource GoldPrimary}"/>
                                                        </Border>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="card" Property="Background" Value="{StaticResource SurfaceHoverBg}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- ======================================== -->
                <!-- SNIPPETS SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsSnippetsVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Snippets de Texto" Style="{StaticResource H1Text}" Margin="0,0,0,8"/>
                    <TextBlock Text="Defina palavras de gatilho que se expandem automaticamente em suas transcrições." Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,24"/>

                    <!-- Add New Snippet -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <TextBlock Text="Adicionar Novo Snippet" Style="{StaticResource H3Text}" Margin="0,0,0,16"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" Text="{Binding NewSnippetTrigger, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource DarkTextBox}"/>
                                <TextBox Grid.Column="2" Text="{Binding NewSnippetReplacement, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource DarkTextBox}"/>
                                <Button Grid.Column="4" Content="Adicionar" Command="{Binding AddSnippetCommand}"
                                        Style="{StaticResource GoldButton}" Padding="20,10"/>
                            </Grid>
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Palavra gatilho" Style="{StaticResource CaptionText}"/>
                                <TextBlock Grid.Column="2" Text="Texto de substituição" Style="{StaticResource CaptionText}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Snippet List -->
                    <ItemsControl ItemsSource="{Binding SnippetsList}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ItemCard}" Margin="0,0,0,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="16"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="16"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Border Grid.Column="0" Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" Padding="12,6">
                                            <TextBlock Text="{Binding Trigger}" FontFamily="Consolas" Style="{StaticResource BodyText}" Foreground="{StaticResource GoldPrimary}"/>
                                        </Border>

                                        <TextBlock Grid.Column="2" Text="→" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Center" FontSize="16"/>

                                        <TextBlock Grid.Column="4" Text="{Binding Replacement}" Style="{StaticResource BodyText}"
                                                   VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>

                                        <Button Grid.Column="5" Content="&#xE7BA;" FontFamily="Segoe MDL2 Assets"
                                                Command="{Binding DataContext.ToggleSnippetCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding Id}" Style="{StaticResource SecondaryButton}" Padding="10,6"
                                                Margin="0,0,8,0" ToolTip="Alternar ativação" Foreground="{StaticResource GoldPrimary}"/>

                                        <Button Grid.Column="6" Content="&#xE74D;" FontFamily="Segoe MDL2 Assets"
                                                Command="{Binding DataContext.RemoveSnippetCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding Id}" Style="{StaticResource DestructiveButton}" Padding="10,6"
                                                ToolTip="Excluir"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Empty State -->
                    <TextBlock Text="Nenhum snippet ainda. Adicione uma palavra gatilho acima para começar."
                               Foreground="{StaticResource TextSecondary}" HorizontalAlignment="Center" Margin="0,32,0,0">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource BodyText}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SnippetsList.Count}" Value="0">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>

                <!-- ======================================== -->
                <!-- WRITING STYLE SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsStyleVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Estilo de Escrita" Style="{StaticResource H1Text}" Margin="0,0,0,8"/>
                    <TextBlock Text="Personalize como suas transcrições soam. Estas configurações ajustam o estilo de saída da IA." Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,24"/>

                    <!-- Enable Toggle -->
                    <Border Style="{StaticResource SectionCard}">
                        <CheckBox Content="Habilitar Personalização de Estilo de Escrita" IsChecked="{Binding StyleEnabled}"
                                  Style="{StaticResource DarkCheckBox}" Foreground="{StaticResource GoldPrimary}" FontWeight="SemiBold"/>
                    </Border>

                    <!-- Sliders (visible when enabled) -->
                    <StackPanel Visibility="{Binding StyleEnabled, Converter={StaticResource BoolToVis}}">

                        <!-- Formality -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <TextBlock Text="Formalidade" Style="{StaticResource BodyText}" FontWeight="SemiBold" HorizontalAlignment="Left"/>
                                    <TextBlock Text="{Binding FormalityLabel}" Style="{StaticResource BodyText}" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Right" FontWeight="Medium"/>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Casual" Style="{StaticResource CaptionText}"/>
                                    <Slider Grid.Column="1" Value="{Binding FormalityLevel}" Minimum="0" Maximum="100"
                                            TickFrequency="10" IsSnapToTickEnabled="True" Style="{StaticResource DarkSlider}" Margin="12,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Formal" Style="{StaticResource CaptionText}" HorizontalAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Verbosity -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <TextBlock Text="Verbosidade" Style="{StaticResource BodyText}" FontWeight="SemiBold" HorizontalAlignment="Left"/>
                                    <TextBlock Text="{Binding VerbosityLabel}" Style="{StaticResource BodyText}" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Right" FontWeight="Medium"/>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Conciso" Style="{StaticResource CaptionText}"/>
                                    <Slider Grid.Column="1" Value="{Binding VerbosityLevel}" Minimum="0" Maximum="100"
                                            TickFrequency="10" IsSnapToTickEnabled="True" Style="{StaticResource DarkSlider}" Margin="12,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Detalhado" Style="{StaticResource CaptionText}" HorizontalAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Technical Level -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <TextBlock Text="Nível Técnico" Style="{StaticResource BodyText}" FontWeight="SemiBold" HorizontalAlignment="Left"/>
                                    <TextBlock Text="{Binding TechnicalLabel}" Style="{StaticResource BodyText}" Foreground="{StaticResource GoldPrimary}" HorizontalAlignment="Right" FontWeight="Medium"/>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Simples" Style="{StaticResource CaptionText}"/>
                                    <Slider Grid.Column="1" Value="{Binding TechnicalLevel}" Minimum="0" Maximum="100"
                                            TickFrequency="10" IsSnapToTickEnabled="True" Style="{StaticResource DarkSlider}" Margin="12,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Técnico" Style="{StaticResource CaptionText}" HorizontalAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Custom Instructions -->
                        <Border Style="{StaticResource SectionCard}" Margin="0">
                            <StackPanel>
                                <TextBlock Text="Instruções Personalizadas" Style="{StaticResource BodyText}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <TextBlock Text="Adicione quaisquer instruções adicionais para como a IA deve processar suas transcrições."
                                           Style="{StaticResource CaptionText}" Margin="0,0,0,12"/>
                                <TextBox Text="{Binding CustomInstructions, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource DarkTextBox}" AcceptsReturn="True" TextWrapping="Wrap"
                                         MinHeight="100" VerticalContentAlignment="Top"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </StackPanel>

                <!-- ======================================== -->
                <!-- SETTINGS SECTION -->
                <!-- ======================================== -->
                <StackPanel Visibility="{Binding IsSettingsVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Configurações" Style="{StaticResource H1Text}" Margin="0,0,0,24"/>

                    <!-- Account -->
                    <TextBlock Text="CONTA" Style="{StaticResource CaptionText}" FontWeight="Bold" Margin="0,0,0,8"/>

                    <!-- Logged In -->
                    <Border Style="{StaticResource SectionCard}" Visibility="{Binding IsLoggedIn, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <TextBlock Text="{Binding Email}" Style="{StaticResource BodyText}" FontWeight="Bold" FontSize="16"/>
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <TextBlock Text="Plano: " Style="{StaticResource CaptionText}"/>
                                <TextBlock Text="{Binding SubscriptionLabel}" Foreground="{StaticResource GoldPrimary}" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="{Binding UsageLabel}" Style="{StaticResource CaptionText}" Margin="0,4,0,0"/>
                            <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                <Button Content="Fazer Upgrade para o Pro" Command="{Binding OpenSubscriptionPageCommand}" Style="{StaticResource GoldButton}"
                                        Visibility="{Binding IsPro, Converter={StaticResource InverseBoolToVis}}" Margin="0,0,12,0"/>
                                <Button Content="Sair" Command="{Binding SignOutCommand}" Style="{StaticResource DestructiveButton}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Logged Out — Login Card -->
                    <StackPanel Visibility="{Binding IsLoggedIn, Converter={StaticResource InverseBoolToVis}}" MaxWidth="400" HorizontalAlignment="Center">
                        <Border Style="{StaticResource SectionCard}" Padding="32">
                            <StackPanel>
                                <!-- Sign In View -->
                                <StackPanel Visibility="{Binding IsSignInView, Converter={StaticResource BoolToVis}}">
                                    <TextBlock Text="Bem-vindo de volta" Style="{StaticResource H2Text}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Faça login na sua conta" Style="{StaticResource CaptionText}" HorizontalAlignment="Center" Margin="0,4,0,24"/>

                                    <Button Command="{Binding SignInWithGoogleCommand}" Style="{StaticResource OutlineButton}" HorizontalAlignment="Stretch" Margin="0,0,0,16">
                                        <TextBlock Text="Entrar com Google" Style="{StaticResource BodyText}" FontWeight="Medium"/>
                                    </Button>

                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="ou continue com e-mail" Style="{StaticResource CaptionText}" Margin="12,0"/>
                                        <Border Grid.Column="2" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" VerticalAlignment="Center"/>
                                    </Grid>

                                    <Border Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" Padding="4" Margin="0,0,0,16">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/><ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <RadioButton Grid.Column="0" Content="Senha" GroupName="SignInMethod" IsChecked="True"
                                                         Style="{StaticResource TabToggleButton}" Command="{Binding SwitchToPasswordMethodCommand}"/>
                                            <RadioButton Grid.Column="1" Content="Link Mágico" GroupName="SignInMethod"
                                                         Style="{StaticResource TabToggleButton}" Command="{Binding SwitchToMagicLinkMethodCommand}"/>
                                        </Grid>
                                    </Border>

                                    <!-- Password Method -->
                                    <StackPanel Visibility="{Binding IsPasswordMethod, Converter={StaticResource BoolToVis}}">
                                        <TextBlock Text="E-mail" Style="{StaticResource BodyText}" FontWeight="Medium" Margin="0,0,0,4"/>
                                        <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}" Margin="0,0,0,12"/>
                                        <Grid Margin="0,0,0,4">
                                            <TextBlock Text="Senha" Style="{StaticResource BodyText}" FontWeight="Medium" HorizontalAlignment="Left"/>
                                            <Button Content="Esqueceu a senha?" Command="{Binding SwitchToResetCommand}" HorizontalAlignment="Right"
                                                    Style="{StaticResource LinkButton}"/>
                                        </Grid>
                                        <PasswordBox x:Name="PasswordBox" Style="{StaticResource DarkPasswordBox}" Margin="0,0,0,16"/>
                                        <TextBlock Text="{Binding StatusMessage}" Foreground="{Binding StatusMessageColor, Converter={StaticResource StringToColor}, FallbackValue='#FF4444'}"
                                                   Style="{StaticResource CaptionText}" Margin="0,0,0,12" TextWrapping="Wrap"/>
                                        <Button Content="Entrar" Command="{Binding SignInCommand}" Style="{StaticResource GoldButton}" HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <!-- Magic Link Method -->
                                    <StackPanel Visibility="{Binding IsMagicLinkMethod, Converter={StaticResource BoolToVis}}">
                                        <TextBlock Text="E-mail" Style="{StaticResource BodyText}" FontWeight="Medium" Margin="0,0,0,4"/>
                                        <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}" Margin="0,0,0,16"/>
                                        <TextBlock Text="{Binding StatusMessage}" Foreground="{Binding StatusMessageColor, Converter={StaticResource StringToColor}, FallbackValue='#FF4444'}"
                                                   Style="{StaticResource CaptionText}" Margin="0,0,0,12" TextWrapping="Wrap"/>
                                        <Button Content="Enviar Link Mágico" Command="{Binding SendMagicLinkCommand}" Style="{StaticResource GoldButton}" HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,24,0,0">
                                        <TextBlock Text="Não tem uma conta? " Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}"/>
                                        <Button Content="Inscrever-se" Command="{Binding SwitchToSignUpCommand}" Style="{StaticResource LinkButton}" FontWeight="Medium"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Sign Up View -->
                                <StackPanel Visibility="{Binding IsSignUpView, Converter={StaticResource BoolToVis}}">
                                    <TextBlock Text="Crie sua conta" Style="{StaticResource H2Text}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Comece a ditar 5x mais rápido" Style="{StaticResource CaptionText}" HorizontalAlignment="Center" Margin="0,4,0,24"/>
                                    <Button Command="{Binding SignInWithGoogleCommand}" Style="{StaticResource OutlineButton}" HorizontalAlignment="Stretch" Margin="0,0,0,16">
                                        <TextBlock Text="Inscrever-se com Google" Style="{StaticResource BodyText}" FontWeight="Medium"/>
                                    </Button>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="ou continue com e-mail" Style="{StaticResource CaptionText}" Margin="12,0"/>
                                        <Border Grid.Column="2" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="E-mail" Style="{StaticResource BodyText}" FontWeight="Medium" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}" Margin="0,0,0,12"/>
                                    <TextBlock Text="Senha" Style="{StaticResource BodyText}" FontWeight="Medium" Margin="0,0,0,4"/>
                                    <PasswordBox x:Name="SignUpPasswordBox" Style="{StaticResource DarkPasswordBox}" Margin="0,0,0,16"/>
                                    <TextBlock Text="{Binding StatusMessage}" Foreground="{Binding StatusMessageColor, Converter={StaticResource StringToColor}, FallbackValue='#FF4444'}"
                                               Style="{StaticResource CaptionText}" Margin="0,0,0,12" TextWrapping="Wrap"/>
                                    <Button Content="Criar Conta" Command="{Binding SignUpCommand}" Style="{StaticResource GoldButton}" HorizontalAlignment="Stretch"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,24,0,0">
                                        <TextBlock Text="Já tem uma conta? " Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}"/>
                                        <Button Content="Entrar" Command="{Binding SwitchToSignInCommand}" Style="{StaticResource LinkButton}" FontWeight="Medium"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Reset Password View -->
                                <StackPanel Visibility="{Binding IsResetView, Converter={StaticResource BoolToVis}}">
                                    <TextBlock Text="Redefinir sua senha" Style="{StaticResource H2Text}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Digite seu e-mail e enviaremos um link de redefinição" Style="{StaticResource CaptionText}" HorizontalAlignment="Center" Margin="0,4,0,24" TextWrapping="Wrap" TextAlignment="Center"/>
                                    <TextBlock Text="E-mail" Style="{StaticResource BodyText}" FontWeight="Medium" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}" Margin="0,0,0,16"/>
                                    <TextBlock Text="{Binding StatusMessage}" Foreground="{Binding StatusMessageColor, Converter={StaticResource StringToColor}, FallbackValue='#FF4444'}"
                                               Style="{StaticResource CaptionText}" Margin="0,0,0,12" TextWrapping="Wrap"/>
                                    <Button Content="Enviar Link de Redefinição" Command="{Binding ResetPasswordCommand}" Style="{StaticResource GoldButton}" HorizontalAlignment="Stretch"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,24,0,0">
                                        <TextBlock Text="Lembrou sua senha? " Style="{StaticResource BodyText}" Foreground="{StaticResource TextSecondary}"/>
                                        <Button Content="Entrar" Command="{Binding SwitchToSignInCommand}" Style="{StaticResource LinkButton}" FontWeight="Medium"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Behavior -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <TextBlock Text="Comportamento" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>
                            <CheckBox Content=" Efeitos Sonoros" IsChecked="{Binding PlaySounds}" Style="{StaticResource DarkCheckBox}" Margin="0,4"/>
                            <TextBlock Text="Tocar sons quando a gravação iniciar e parar" Style="{StaticResource CaptionText}" Margin="28,2,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Voice Commands (Wake Word) -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <StackPanel HorizontalAlignment="Left">
                                    <TextBlock Text="Comandos de Voz" Style="{StaticResource H3Text}"/>
                                    <TextBlock Text="Alternar modos usando sua voz" Style="{StaticResource CaptionText}" Margin="0,4,0,0"/>
                                </StackPanel>
                                <CheckBox Content="Habilitar" IsChecked="{Binding WakeWordEnabled}" Style="{StaticResource DarkCheckBox}" Foreground="{StaticResource GoldPrimary}"
                                          HorizontalAlignment="Right" VerticalAlignment="Center" FontWeight="SemiBold"/>
                            </Grid>
                            <StackPanel Visibility="{Binding WakeWordEnabled, Converter={StaticResource BoolToVis}}">
                                <Grid Margin="0,0,0,12">
                                    <TextBlock Text="Palavra de Despertar" Style="{StaticResource BodyText}" FontWeight="Medium" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                    <TextBox Text="{Binding WakeWord, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"
                                             HorizontalAlignment="Right" Width="200"/>
                                </Grid>
                                <Border Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" Padding="12,8">
                                    <StackPanel>
                                        <TextBlock Style="{StaticResource CaptionText}" TextWrapping="Wrap">
                                            <Run Text="Diga &quot;"/><Run Text="{Binding WakeWord, Mode=OneWay}" Foreground="{StaticResource GoldPrimary}"/><Run Text=", E-mail&quot; para alternar para o modo E-mail"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Keyboard Shortcuts -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <TextBlock Text="Atalhos de Teclado" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>
                            <Grid>
                                <TextBlock Text="Gravar" Style="{StaticResource BodyText}" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <Border Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="6" Padding="10,4" HorizontalAlignment="Right">
                                    <TextBlock Text="Alt + Win (segurar)" FontFamily="Consolas" Style="{StaticResource CaptionText}" Foreground="{StaticResource GoldPrimary}"/>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Data -->
                    <Border Style="{StaticResource SectionCard}">
                        <StackPanel>
                            <TextBlock Text="Dados" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>
                            <Grid>
                                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Center">
                                    <TextBlock Text="Histórico de Transcrição" Style="{StaticResource BodyText}" FontWeight="Medium"/>
                                    <TextBlock Style="{StaticResource CaptionText}" Margin="0,4,0,0">
                                        <Run Text="{Binding HistoryRecords.Count, Mode=OneWay}"/>
                                        <Run Text="itens salvos"/>
                                    </TextBlock>
                                </StackPanel>
                                <Button Content="Limpar Histórico" Command="{Binding ClearHistoryCommand}"
                                        Style="{StaticResource DestructiveButton}" HorizontalAlignment="Right" VerticalAlignment="Center" Padding="16,8"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- About -->
                    <Border Style="{StaticResource SectionCard}" Margin="0">
                        <StackPanel>
                            <TextBlock Text="Sobre" Style="{StaticResource H3Text}" Margin="0,0,0,12"/>
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="Modelo" Style="{StaticResource BodyText}" HorizontalAlignment="Left" Foreground="{StaticResource TextSecondary}"/>
                                <TextBlock Text="Vox AI Engine" Style="{StaticResource BodyText}" HorizontalAlignment="Right"/>
                            </Grid>
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="Versão" Style="{StaticResource BodyText}" HorizontalAlignment="Left" Foreground="{StaticResource TextSecondary}"/>
                                <TextBlock x:Name="VersionLabel" Text="3.0.0 (Windows)" Style="{StaticResource BodyText}" HorizontalAlignment="Right"
                                           Cursor="Hand" MouseLeftButtonDown="VersionLabel_MouseLeftButtonDown"/>
                            </Grid>
                            <Grid>
                                <TextBlock Text="Motor" Style="{StaticResource BodyText}" HorizontalAlignment="Left" Foreground="{StaticResource TextSecondary}"/>
                                <TextBlock Text="Google Gemini via Supabase" Style="{StaticResource BodyText}" HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- DevTools (Easter Egg — session only, unlocked by tapping version 5x) -->
                    <Border Style="{StaticResource SectionCard}" Margin="0,16,0,0"
                            Visibility="{Binding IsDevToolsVisible, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="&#xE90F;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="#FF6666" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="Dev Tools" Style="{StaticResource H3Text}" Foreground="#FF6666"/>
                                <TextBlock Text="(session only)" Style="{StaticResource CaptionText}" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>

                            <TextBlock Text="Force subscription state (syncs to Supabase server):" Style="{StaticResource CaptionText}" Margin="0,0,0,12"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="Force Free" Command="{Binding DevForceFreePlanCommand}" Margin="0,0,8,0" Padding="16,8">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource OutlineButton}">
                                            <Setter Property="Foreground" Value="#FF6666"/>
                                            <Setter Property="BorderBrush" Value="#FF6666"/>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button Content="Start Trial" Command="{Binding DevStartTrialCommand}" Margin="0,0,8,0" Padding="16,8">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource OutlineButton}">
                                            <Setter Property="Foreground" Value="#D4A017"/>
                                            <Setter Property="BorderBrush" Value="#D4A017"/>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button Content="Force Pro" Command="{Binding DevForceProCommand}" Padding="16,8">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource OutlineButton}">
                                            <Setter Property="Foreground" Value="#00CC88"/>
                                            <Setter Property="BorderBrush" Value="#00CC88"/>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>

                            <!-- Current state display -->
                            <Border Background="{StaticResource AppBg}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" Padding="12,8" Margin="0,12,0,0">
                                <StackPanel>
                                    <TextBlock Style="{StaticResource CaptionText}" FontFamily="Consolas" TextWrapping="Wrap">
                                        <Run Text="Plan: "/><Run Text="{Binding SubscriptionLabel, Mode=OneWay}" Foreground="{StaticResource GoldPrimary}"/>
                                        <Run Text="  |  IsPro: "/><Run Text="{Binding IsPro, Mode=OneWay}" Foreground="{StaticResource GoldPrimary}"/>
                                    </TextBlock>
                                    <TextBlock Style="{StaticResource CaptionText}" FontFamily="Consolas" TextWrapping="Wrap">
                                        <Run Text="Usage: "/><Run Text="{Binding UsageLabel, Mode=OneWay}" Foreground="{StaticResource GoldPrimary}"/>
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>

            </Grid>
        </ScrollViewer>
    </Grid>
</Window>
